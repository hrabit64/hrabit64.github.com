---
title: 유니티 ML_Agents 공부해보기 - 기본구조(3) Academy
categories: ML_Agents
tags: [ML_Agents,Unity]
toc: true
toc_label: 목차
toc_sticky: true
classes: wide
---



## 0. 기본 구조

유니티 블로그에서는 아카데미를 다음과 같이 설명하고 있다.

***"특정 씬에 있는 아카데미 오브젝트는 해당 환경에 포함된 모든 브레인을 자식으로 포함하고 있습니다. 각 환경은 환경의 범위를 정의하는 한 개의 아카데미를 포함하고 있으며, 그 정의는 다음과 같은 내용을 포함합니다."***



이 아카데미가 포함하는 항목은 다음과 같다.

**● 브레인 설정**

**● 화면 해상도 및 크기 설정**

**● 몇 스텝마다 화면을 업데이트할지 결정**

**● 타겟 frame rate**

**● 리셋 파라미터**

**● 환경이 초기화 되거나 리셋될 때의 설정**



지난번 브레인을 공부할 때 살펴봤던 3D 볼 예제의 아카데미를 살펴보자

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using MLAgents;

public class Ball3DAcademy : Academy
{
    public override void AcademyReset()
    {

    }

    public override void AcademyStep()
    {

    }
}

```

코드를 살펴보면 2가지 함수가 보인다. 예제에는 나와있지 않지만 추가로 InitializeAcademy() 함수까지 기능을 설명하자면 다음과 같다.

**InitializeAcademy()** : 처음 환경이 실행될 때, 아카데미를 초기화하기 위해 딱 한번 호출되는 함수

**AcademyReset()** : 이 함수는 환경의 에피소드가 끝날 때 마자 호출되는 함수이다.

**AcademyStep()** : 이 함수는 매 스텝마다 호출되는 함수이다.



## 1. 인스펙터 뷰



인스텍터 뷰 최상단에는 Broadcast hub 항목이 있다. 이 항목에는 이 환경 내에서 사용할 브레인들을 모두 추가해주면 된다. 만약 러닝브레인이라면, Control 체크박스를 사용하면 파이썬 코드 내에서 이 브레인이 연결된 에이전트를 제어할 수 있다.



Max Steps는 지정한 스텝만큼 환경 내에서 스텝이 진행되면 한 에피소드를 강제로 종료하고 환경을 리셋한다. 다시 말해 어떤 상황이던 이 맥스스텝 만큼 스텝이 진행되면 더 이상 학습을 하지 않는다.



그 밑에는 Configuration이라는 부분이 있는데 이 곳에는 Training Configuration(학습시 유니티 환경에 대한 설정), Inference Configuration(학습이 끝나고 알고리즘을 테스트할 때의 환경)이 있다. 



또한  Quality Level은 환경의 그래픽 품질을 얼마나 좋게 할 것인지 결정한다. 일반적으로 학습시에는 연산량을 줄이기 위해 값을 낮추고, 테스트 할때는 값을 높인다.



Time Scale은 몇 스텝마다 환경의 화면을 업데이트할지 결정한다. 이 값은 그저 보여주는 화면을 갱신하는 과정이지, 스텝은 정상적으로 진행된다.



Target Frame Rate는 게임의 프레임을 설정하는 값이다. 만약 -1을 입력한다면 연산이 끝나자마자 프레임을 진행한다. 다만 만약 60으로 해두고, 연산이 느리다면 정상적으로 학습이 되지 않을 수 도 있기에, 통상적으로 -1로 설정해두는 편이다. 다만 테스트는 실제 게임과 유사한 환경에서 성능을 테스트해야 하므로, 게임의 프레임과 동일하게 설정해둔다.



마지막으로 리셋마라미터이다. 환경이 리셋될 때마다 변경할 수 있는 파라미터들로 주로 환경에 대한 설정값이다. 이 기능을 잘 활용한다면 하나의 환경으로 여러개의 환경을 만들 수도 있다.



